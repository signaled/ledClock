# 요구사항 정의서

## 프로젝트: BLE LED 픽셀 디스플레이 (라즈베리파이)

---

## 1. 시스템 개요

라즈베리파이에서 BLE를 통해 64x64 LED 매트릭스 디스플레이(iPixel Color 계열)를 제어하여
날짜/시간, 날씨 정보, 배경 이미지/애니메이션을 표시하는 스마트 디스플레이 시스템.

---

## 2. 하드웨어 환경

| 항목 | 사양 |
|------|------|
| 컨트롤러 | 라즈베리파이 (BLE 지원) |
| 디스플레이 | 64x64 RGB LED 매트릭스 |
| 통신 | Bluetooth Low Energy (BLE) |
| BLE 디바이스 이름 | `IDM-*` 또는 `LED_BLE_*` |
| 제어 라이브러리 | `pypixelcolor` (lucagoc) |
| GATT Write UUID | `0000fa02-0000-1000-8000-00805f9b34fb` |
| GATT Notify UUID | `0000fa03-0000-1000-8000-00805f9b34fb` |

---

## 3. 기능 요구사항

### 3.1 BLE 연결 관리
- **R-101**: 라즈베리파이 부팅 시 LED 디바이스를 자동으로 스캔·연결한다
- **R-102**: 연결이 끊어지면 자동으로 재연결을 시도한다
- **R-103**: `pypixelcolor` 라이브러리를 통해 디바이스와 통신한다

### 3.2 날짜/시간 표시 (기본 화면)
- **R-201**: 현재 날짜와 시간을 실시간으로 표시한다
- **R-202**: 시간은 1초 또는 1분 단위로 갱신한다
- **R-203**: 날짜 형식: `YYYY-MM-DD` 또는 `MM/DD (요일)`
- **R-204**: 시간 형식: `HH:MM` (24시간제)

### 3.3 날씨 정보 표시
- **R-301**: 외부 날씨 API에서 오늘 날씨를 가져와 표시한다
- **R-302**: 내일 날씨 예보도 함께 표시한다
- **R-303**: 표시 항목: 날씨 아이콘, 현재 기온, 최저/최고 기온
- **R-304**: 날씨 데이터는 주기적으로 갱신한다 (예: 30분~1시간 간격)

### 3.4 배경 이미지/애니메이션
- **R-401**: 정적 이미지를 64x64 배경으로 표시할 수 있다
- **R-402**: GIF 애니메이션을 배경으로 재생할 수 있다
- **R-403**: 여러 배경을 등록하고 시간대/조건별로 전환할 수 있다

### 3.5 화면 레이아웃 및 합성
- **R-501**: 배경(이미지/애니메이션) 위에 텍스트(시간/날씨)를 오버레이한다
- **R-502**: 각 콘텐츠의 배치 영역(위치, 크기)을 설정할 수 있다
- **R-503**: 한글 폰트를 지원한다

### 3.6 시스템 운영
- **R-601**: 라즈베리파이 부팅 시 자동으로 서비스가 시작된다
- **R-602**: 설정 파일(JSON/YAML)로 동작을 구성할 수 있다
- **R-603**: 오류 발생 시 로그를 기록한다

---

## 4. 비기능 요구사항

- **NR-01**: Python 3.9 이상에서 동작한다
- **NR-02**: asyncio 기반 비동기 처리로 BLE 통신과 렌더링을 병행한다
- **NR-03**: 라즈베리파이 리소스(CPU/메모리)를 고려하여 경량으로 구현한다

---

## 5. 외부 의존성

| 라이브러리 | 용도 |
|-----------|------|
| `pypixelcolor` | BLE LED 디바이스 제어 |
| `bleak` | BLE 통신 (pypixelcolor 의존성) |
| `Pillow` | 이미지 처리, 텍스트 렌더링, 프레임 합성 |
| `aiohttp` 또는 `requests` | 날씨 API 호출 |
| `crccheck` | CRC32 체크섬 (pypixelcolor 의존성) |
